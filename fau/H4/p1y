#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Fri Mar  2 10:29:53 2018

@author: valen
"""

import csv

def openFile(fileName, mode):
    try:
        f = open(fileName, mode)
        reader = csv.reader(f)
        return reader
        f.close()
    except:
        print("Coud not open the file {} with mode {}.".format(fileName, mode))
        
def fromDicttoList(myDict):
    myList = []
    for key,val in myDict.items():
        myList.append((val, key))
    myList.sort(reverse=True)
    return myList

def print5firstElementsFromList(myList, title = '--' , numberElements = 5):
    print(title)
    for i in myList:
        print(i)
        numberElements -= 1
        if(numberElements <= 0):
            break
        
def main():
    directorsDict = {}
    top5directorsDic = {}
    gross5directorsDic = {}
    top5RatedActorsDic = {}
    
    imdbTopGrossingDict = {}
    actorNameDict = {}
    
    """
    get direcotDictionary
    """
    
    reader3 = openFile("imdb-top-casts.csv", "r")
    for row in reader3:
        directorsDict[(row[0],row[1])] = row[2:]
    
    reader = openFile("imdb-top-rated.csv", "r")
    for row in reader:
        try:
            int(row[0])
            if((directorsDict[(row[1],row[2])][0]) in top5directorsDic):
                top5directorsDic[directorsDict[(row[1],row[2])][0]] +=1
            else:
                top5directorsDic[(directorsDict[(row[1],row[2])][0])] =1
                
                
            if((directorsDict[(row[1],row[2])][1]) in top5RatedActorsDic):
                top5RatedActorsDic[directorsDict[(row[1],row[2])][1]] +=1
            else:
                top5RatedActorsDic[(directorsDict[(row[1],row[2])][1])] =1

            
        except:
            continue


    reader2 = openFile("imdb-top-grossing.csv", "r")
    for row in reader2:
        try:
            int(row[0])
            
            imdbTopGrossingDict[(row[1],row[2])] = row[3:]
            
            if((directorsDict[(row[1],row[2])][0]) in gross5directorsDic):
                gross5directorsDic[directorsDict[(row[1],row[2])][0]] +=1
            else:
                gross5directorsDic[(directorsDict[(row[1],row[2])][0])] =1
                
                
            if((directorsDict[(row[1],row[2])][0]) in gross5directorsDic):
                gross5directorsDic[directorsDict[(row[1],row[2])][0]] +=1
            else:
                gross5directorsDic[(directorsDict[(row[1],row[2])][0])] =1
            
            
        except:
            continue
    """
    Populating dictionary actorNameDict with a key being the name of the actor, 
    and the value being a list of tuples in the format (FilmeName, year)
    """
    for key,value in directorsDict.items():
        #print(value, key)
        if(value[1] in actorNameDict):
            actorNameDict[value[1]].append((key[0],key[1]))
        else:
            actorNameDict[value[1]] = [(key[0],key[1])]
        
    print(type(actorNameDict))
    print(actorNameDict['Tom Hanks'])

    listTop5 = fromDicttoList(top5directorsDic)
    print5firstElementsFromList(listTop5, "List of the top 5 directors with most movies in the top rated list", 5)
    
    print("\n")
    
    listGross5 = fromDicttoList(gross5directorsDic)
    print5firstElementsFromList(listGross5, "List of the top 5 directors with most movies in the top grossing list", 5)

    print("\n")
    
    listTop5Rated = fromDicttoList(top5RatedActorsDic)
    print5firstElementsFromList(listTop5Rated, "List of the top 5 actors with most movies in the top rated list", 5)
    
    print(directorsDict[('101 Dalmatians', '1961')]) 
    #print(directorsDict)
    #print(type(imdbTopGrossingDict))
    #print(imdbTopGrossingDict)
    
   
    #print(listGross5)
    
   
    

main()
